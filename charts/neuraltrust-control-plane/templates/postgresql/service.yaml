{{- if include "control-plane.postgresql.deploy" . }}
  {{- with .Values.controlPlane.components.postgresql }}
apiVersion: v1
kind: Service
metadata:
  name: control-plane-postgresql
  labels:
    app: control-plane-postgresql
spec:
  type: {{ if .service }}{{ .service.type | default "ClusterIP" }}{{ else }}ClusterIP{{ end }}
  ports:
  - port: {{ if .service }}{{ .service.port | default 5432 }}{{ else }}5432{{ end }}
    targetPort: postgresql
    protocol: TCP
    name: postgresql
  selector:
    app: control-plane-postgresql
  {{- end }}
{{- end }} 