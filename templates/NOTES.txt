NeuralTrust Platform has been deployed!

{{- if .Values.global.autoGenerateSecrets }}
Secrets have been auto-generated for this deployment.
  - SERVER_SECRET_KEY and TRUSTGATE_JWT_SECRET are synchronized.
  - Existing secrets are preserved on upgrades.
  - To view generated secrets: kubectl get secrets -n {{ .Release.Namespace }}
{{- end }}

{{- if .Values.infrastructure.clickhouse.deploy }}
ClickHouse has been deployed in this release.
{{- else }}
Using external ClickHouse at {{ .Values.infrastructure.clickhouse.external.host }}:{{ .Values.infrastructure.clickhouse.external.port }}
{{- end }}

{{- if .Values.infrastructure.kafka.deploy }}
Kafka has been deployed in this release.
{{- else }}
Using external Kafka at {{ .Values.infrastructure.kafka.external.bootstrapServers }}
{{- end }}

{{- $postgresql := false }}
{{- $postgresqlHost := "" }}
{{- $postgresqlPort := "" }}
{{- $postgresqlDeploy := false }}
{{- $cpValues := index .Values "neuraltrust-control-plane" }}
{{- if and $cpValues $cpValues.infrastructure $cpValues.infrastructure.postgresql (hasKey $cpValues.infrastructure.postgresql "deploy") }}
  {{- $postgresqlDeploy = $cpValues.infrastructure.postgresql.deploy }}
{{- end }}
{{- if $postgresqlDeploy }}
  {{- $postgresql = true }}
  {{- $postgresqlHost = "control-plane-postgresql" }}
  {{- $postgresqlPort = "5432" }}
{{- else if and $cpValues $cpValues.controlPlane $cpValues.controlPlane.components $cpValues.controlPlane.components.postgresql $cpValues.controlPlane.components.postgresql.secrets $cpValues.controlPlane.components.postgresql.secrets.host }}
  {{- $postgresql = false }}
  {{- $postgresqlHost = $cpValues.controlPlane.components.postgresql.secrets.host }}
  {{- if $cpValues.controlPlane.components.postgresql.secrets.port }}
    {{- $postgresqlPort = $cpValues.controlPlane.components.postgresql.secrets.port }}
  {{- else }}
    {{- $postgresqlPort = "5432" }}
  {{- end }}
{{- end }}
{{- if $postgresql }}
PostgreSQL has been deployed in this release.
{{- else if $postgresqlHost }}
Using external PostgreSQL at {{ $postgresqlHost }}:{{ $postgresqlPort }}
{{- else }}
PostgreSQL configuration not specified.
{{- end }}

{{- $dpValues := index .Values "neuraltrust-data-plane" }}
{{- if and $dpValues $dpValues.dataPlane $dpValues.dataPlane.enabled }}
NeuralTrust Data Plane is enabled.
{{- end }}

{{- $cpValues := index .Values "neuraltrust-control-plane" }}
{{- if and $cpValues $cpValues.controlPlane $cpValues.controlPlane.enabled }}
NeuralTrust Control Plane is enabled.
{{- end }}

{{- if .Values.trustgate.enabled }}
TrustGate is enabled.
{{- end }}

Ingress endpoints:
  kubectl get ingress -n {{ .Release.Namespace }}
{{- if .Values.trustgate.enabled }}
{{- if .Values.trustgate.ingress.enabled }}
  {{- if .Values.trustgate.ingress.controlPlane.host }}
  - TrustGate Admin:   https://{{ .Values.trustgate.ingress.controlPlane.host }}
  {{- else }}
  - TrustGate Admin:   kubectl get ingress trustgate-admin -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
  {{- if .Values.trustgate.ingress.dataPlane.host }}
  - TrustGate Gateway: https://{{ .Values.trustgate.ingress.dataPlane.host }}
  {{- else }}
  - TrustGate Gateway: kubectl get ingress trustgate-gateway -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
  {{- if .Values.trustgate.ingress.actions.host }}
  - TrustGate Actions: https://{{ .Values.trustgate.ingress.actions.host }}
  {{- else }}
  - TrustGate Actions: kubectl get ingress trustgate-actions -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
{{- end }}
{{- end }}
{{- $cpValues := index .Values "neuraltrust-control-plane" }}
{{- if and $cpValues $cpValues.controlPlane $cpValues.controlPlane.enabled }}
{{- if and $cpValues.controlPlane.components $cpValues.controlPlane.components.api $cpValues.controlPlane.components.api.ingress $cpValues.controlPlane.components.api.ingress.enabled }}
  {{- if $cpValues.controlPlane.components.api.host }}
  - Control Plane API: https://{{ $cpValues.controlPlane.components.api.host }}
  {{- else }}
  - Control Plane API: kubectl get ingress control-plane-api-ingress -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
{{- end }}
{{- if and $cpValues.controlPlane.components $cpValues.controlPlane.components.app $cpValues.controlPlane.components.app.ingress $cpValues.controlPlane.components.app.ingress.enabled }}
  {{- if $cpValues.controlPlane.components.app.host }}
  - Control Plane App: https://{{ $cpValues.controlPlane.components.app.host }}
  {{- else }}
  - Control Plane App: kubectl get ingress control-plane-app-ingress -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
{{- end }}
{{- if and $cpValues.controlPlane.components $cpValues.controlPlane.components.scheduler $cpValues.controlPlane.components.scheduler.ingress $cpValues.controlPlane.components.scheduler.ingress.enabled }}
  {{- if $cpValues.controlPlane.components.scheduler.host }}
  - Scheduler:         https://{{ $cpValues.controlPlane.components.scheduler.host }}
  {{- else }}
  - Scheduler:         kubectl get ingress control-plane-scheduler-ingress -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
{{- end }}
{{- end }}
{{- $dpValues := index .Values "neuraltrust-data-plane" }}
{{- if and $dpValues $dpValues.dataPlane $dpValues.dataPlane.enabled }}
{{- if and $dpValues.dataPlane.components $dpValues.dataPlane.components.api $dpValues.dataPlane.components.api.ingress $dpValues.dataPlane.components.api.ingress.enabled }}
  {{- if $dpValues.dataPlane.components.api.host }}
  - Data Plane API:    https://{{ $dpValues.dataPlane.components.api.host }}
  {{- else }}
  - Data Plane API:    kubectl get ingress data-plane-api-ingress -n {{ .Release.Namespace }} -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
  {{- end }}
{{- end }}
{{- end }}

  Note: It may take a few minutes for ALB URLs to be provisioned by the AWS Load Balancer Controller.

To get the status of your deployment, run:
  kubectl get pods -n {{ .Release.Namespace }}

To view logs for specific components:
{{- $cpValues := index .Values "neuraltrust-control-plane" }}
{{- if and $cpValues $cpValues.controlPlane $cpValues.controlPlane.enabled }}
  # NeuralTrust Control Plane
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=neuraltrust-control-plane,app.kubernetes.io/instance={{ .Release.Name }}
{{- end }}
{{- $dpValues := index .Values "neuraltrust-data-plane" }}
{{- if and $dpValues $dpValues.dataPlane $dpValues.dataPlane.enabled }}
  # NeuralTrust Data Plane
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=neuraltrust-data-plane,app.kubernetes.io/instance={{ .Release.Name }}
{{- end }}
{{- if .Values.trustgate.enabled }}
  # TrustGate Control Plane
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=trustgate,app.kubernetes.io/instance={{ .Release.Name }},component=control-plane
  # TrustGate Data Plane
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=trustgate,app.kubernetes.io/instance={{ .Release.Name }},component=data-plane
{{- end }}
{{- if .Values.infrastructure.clickhouse.deploy }}
  # ClickHouse
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=clickhouse,app.kubernetes.io/instance={{ .Release.Name }}
{{- end }}
{{- if .Values.infrastructure.kafka.deploy }}
  # Kafka
  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name=kafka,app.kubernetes.io/instance={{ .Release.Name }}
{{- end }}

To view logs for all pods in the namespace:
  kubectl logs -n {{ .Release.Namespace }} --all-containers=true -l app.kubernetes.io/instance={{ .Release.Name }}

For more information, see the README.md file.

