# Example: Deploy everything (ClickHouse, Kafka, PostgreSQL, NeuralTrust, TrustGate)
# This is the default configuration - deploy all infrastructure and services
#
# Usage:
#   helm install neuraltrust-platform . -f values-all-deployed.yaml.example
#
# This example shows:
# - Deploying all infrastructure components (ClickHouse, Kafka, PostgreSQL)
# - Deploying all NeuralTrust components (Control Plane and Data Plane)
# - Deploying TrustGate
# - Using Helm-managed secrets (preserveExistingSecrets: false)
# - Using Ingress for external access (Kubernetes) or Routes (OpenShift)

# Global settings
global:
  openshift: false  # Set to true if using OpenShift
  openshiftDomain: ""  # OpenShift wildcard DNS domain (e.g., *.apps.example.com)
  imageRegistry: ""  # Global image registry prefix
  preserveExistingSecrets: false  # Set to true if secrets are pre-generated
  storageClass: ""  # Global storage class for persistent volumes

# Infrastructure Components - Deploy all
infrastructure:
  clickhouse:
    deploy: true  # Deploy ClickHouse
    # ClickHouse chart values are passed via root-level 'clickhouse:' section
    # See values.yaml for full configuration

  kafka:
    deploy: true  # Deploy Kafka
    # Kafka chart values are passed via root-level 'kafka:' section
    # See values.yaml for full configuration

  postgresql:
    # Note: PostgreSQL deployment is controlled by neuraltrust-control-plane.infrastructure.postgresql.deploy below
    # Set deploy: true/false in that section to enable/disable in-cluster PostgreSQL deployment

# NeuralTrust Control Plane - Deploy all components
neuraltrust-control-plane:
  infrastructure:
    postgresql:
      deploy: true  # Deploy PostgreSQL in-cluster
  controlPlane:
    enabled: true
    components:
      postgresql:
        secrets:
          password: "your-postgres-password"  # Define this value
          database: "neuraltrust"
      api:
        enabled: true
        host: "control-plane-api.example.com"
        ingress:
          enabled: true  # Use Ingress for external access
      app:
        enabled: true
        host: "control-plane-app.example.com"
        ingress:
          enabled: true  # Use Ingress for external access
      scheduler:
        enabled: true
        host: "control-plane-scheduler.example.com"
        ingress:
          enabled: true  # Use Ingress for external access

# NeuralTrust Data Plane - Deploy all components
neuraltrust-data-plane:
  dataPlane:
    enabled: true
    components:
      clickhouse:
        enabled: true  # ClickHouse will be deployed via infrastructure.clickhouse.deploy
        host: "clickhouse"  # Internal service name
      kafka:
        enabled: true  # Kafka will be deployed via infrastructure.kafka.deploy
      api:
        enabled: true
        host: "data-plane-api.example.com"
        ingress:
          enabled: true  # Use Ingress for external access
      worker:
        enabled: true

# TrustGate - Deploy all components
trustgate:
  enabled: true
  global:
    env:
      DATABASE_HOST: "control-plane-postgresql"  # Use control-plane PostgreSQL
      DATABASE_PORT: "5432"
      DATABASE_USER: "trustgate"  # Define this value
      DATABASE_PASSWORD: "your-trustgate-db-password"  # Define this value
      DATABASE_NAME: "trustgate"
      DATABASE_SSL_MODE: "disable"  # Use "disable" for in-cluster PostgreSQL
  ingress:
    enabled: true  # Use Ingress for external access
    controlPlane:
      host: "admin.example.com"
    dataPlane:
      host: "gateway.example.com"
    actions:
      host: "actions.example.com"
